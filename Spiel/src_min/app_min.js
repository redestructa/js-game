var d,e,f,g=0,h=[50,500,100,20],i,j=[100,400],m=10,n=4,o=-4,p=!1,q=0,r=0;window.b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){window.setTimeout(c,1E3/60)};
function s(){e.clearRect(0,0,d.width,d.height);0>n?(t=j[0]-m,u=j[1]):0<n&&(t=j[0]+m-1,u=j[1]);0>o?(v=j[0],w=j[1]-m+1):0<o&&(v=j[0],w=j[1]+m-1);for(var c in f){if(f[c].x<=t&&t<=f[c].x+50&&f[c].y<=u&&u<=f[c].y+20)n*=-0.9-Math.random()/5;else if(f[c].x<=v&&v<=f[c].x+50&&f[c].y<=w&&w<=f[c].y+20)o*=-0.9-Math.random()/5;else continue;q+=f[c].a;document.getElementById("lblScore").innerHTML=q;if(q>r){var a=q;r=a;window.localStorage.setItem("highscore",a);document.getElementById("lblHighscore").innerHTML=
a}f[c]=f[f.length-1];f.pop();break}for(c=0;c<f.length;c++)a=f[c],e.beginPath(),e.lineWidth=0,e.moveTo(a.x,a.y),e.lineTo(a.x+50,a.y),e.lineTo(a.x+50,a.y+20),e.lineTo(a.x,a.y+20),e.lineTo(a.x,a.y),e.fillStyle=a.color,e.stroke(),e.fill();h[0]+=2*g;c=h[0];var a=h[1],l=h[2],k=h[3];e.beginPath();e.lineWidth=1;e.moveTo(c,a);e.lineTo(c+l,a);e.lineTo(c+l,a+k);e.lineTo(c,a+k);e.lineTo(c,a);e.fillStyle="#000";e.stroke();e.fill();c=j[0];a=j[1];c+m>=d.width?n*=-1:0>=c-m&&(n*=-1);a+m>=h[1]&&a+m<=h[1]+5&&c>=h[0]&&
c<=h[0]+h[2]?p?(k=f[Math.floor(Math.random()*f.length)],l=k.x+25-j[0],k=k.y+10-j[1],o=5*(-k/k),n=5*(-l/k)):o*=-1:0>=a-m?o*=-1:a+m>=d.height&&(j[0]=50,j[1]=400,n*=-1,o*=-1);e.beginPath();e.fillStyle="#3a8";e.arc(c,a,m,0,2*Math.PI,!0);e.closePath();e.fill();j[0]+=n;j[1]+=o;window.b(function(){s()})}
function x(c,a,l){switch(c){case 0:this.color="#000";this.a=100;break;case 1:this.color="#f00";this.a=200;break;case 2:this.color="#0f0";this.a=500;break;case 3:this.color="#0ff",this.a=1E3}this.x=a;this.y=l}var t,u,v,w;
document.addEventListener("DOMContentLoaded",function(){d=document.getElementById("canvas");e=d.getContext("2d");f=[];for(var c=0;50>c;c++){var a=100*Math.random(),l=Math.floor(c/5),k=2*(c%5)+0.5*(l%10);5>a?a=3:15>a?a=2:35>a?a=1:100>a&&(a=0);f[c]=new x(a,52*l+5,22*k+5)}s();r=window.localStorage.getItem("highscore");document.getElementById("lblHighscore").innerHTML=r;window.addEventListener("keydown",function(a){g=0;if(37==a.keyCode||39==a.keyCode)g=37==a.keyCode?-5:5,a.preventDefault(),a.stopPropagation();
i=a.keyCode},!1);window.addEventListener("keyup",function(a){if(i==a.keyCode&&(37==a.keyCode||39==a.keyCode))g=0},!1)},!1);
